
# 要件定義


## 1. MVP（Minimum Viable Product）要件

最初のフェーズで実現を目指す最小限の機能セットです。これらを動かせるようになることが最初のゴールとなります。

1.  **環境データと電力消費量の安定的な収集と可視化**
    * **Raspberry Pi** で **SwitchBot Hub 2**（温度、湿度、照度）と **SwitchBot Plug Mini**（電力消費量）からデータを取得し、**AWS IoT Core** を経由して **DynamoDB** に保存する。
        * データ取得頻度：21:00 から翌朝 8:00 までの間、温度・湿度・照度は **5分に1回**、電力消費量は **10分に1回**。
    * Webアプリケーション（**Next.js**）で、収集された環境データと電力消費量を時系列グラフで**可視化**する。
2.  **睡眠の質の評価とデータ連携**
    * Webアプリケーションで、ユーザーが朝に前夜の「**睡眠の質（1〜5段階評価）**」を**手動で入力・保存**できるようにする。
    * **AutoSleep や Health Auto Export からエクスポートした睡眠データ（CSVなど）をWebアプリケーションから手動でアップロードし、DynamoDB に保存できる**ようにする。
3.  **基礎的なエアコン制御**
    * Webアプリケーションから、**手動でエアコンのON/OFFや温度設定**ができるようにする（まずは簡単なデモ機能として）。
    * Webアプリケーションからのリクエストを受け取った**AWS Lambda関数**が、**SwitchBot API** を直接叩いてエアコンを操作する。
4.  **電力消費を考慮した機械学習プロトタイプ**
    * 収集した環境データ、電力消費データ、睡眠の質データを用いて、**AWS SageMaker Studio Lab** 上で**機械学習モデルのプロトタイプを構築・評価**する。

---

## 2. 将来的な拡張要件

MVP達成後、段階的に追加・改善していく機能です。

### a. 機械学習モデルの高度化とMOLOps

* **リアルタイム推論:** 自動調整システムへのリアルタイム推論組み込み（Lambda上でのモデル実行）。
* **モデルの自動再学習:** 新しいデータが蓄積された際に、定期的にモデルを自動で再学習し、デプロイする仕組み（MLOps）。
* **外部データ連携:** 気象情報（外気温、湿度など）や花粉情報などを外部APIから取得し、特徴量としてMLモデルに組み込む。
* **強化学習の導入:** ユーザーのフィードバックや電力消費データに基づき、より最適な制御戦略を自律的に学習する強化学習モデルの検討。

### b. 自動最適化制御の強化

* **電力消費を考慮した省エネ制御:** 快適性を維持しつつ、電力消費を最小限に抑えるための高度な最適化アルゴリズムの実装。
* **パーソナライズされた制御:** 個人の日々の体調や睡眠パターンに合わせた、よりきめ細やかなエアコン制御。
* **複数デバイス連携:** 将来的に加湿器、空気清浄機、照明など、他のスマートデバイスとの連携による包括的な環境制御。

### c. ユーザーインターフェース (UI) / ユーザーエクスペリエンス (UX) の向上

* **ダッシュボードの機能強化:** 過去の睡眠ログとの比較、トレンド分析、省エネ効果の可視化。
* **通知機能:** 睡眠の質が悪化傾向にある場合の警告、エアコン調整の通知など。
* **モバイルアプリ:** より手軽に利用できるネイティブモバイルアプリケーションの提供（iOS/Android）。

### d. システムの運用と堅牢性

* **Infrastructure as Code (IaC):** AWS CDKなどを利用して、全てのAWSリソースをコードで管理し、環境構築の自動化とバージョン管理を徹底する。
* **CI/CDパイプラインの強化:** 自動テスト、デプロイのさらなる自動化と高速化。
* **包括的なモニタリングとアラート:** CloudWatchなどを用いたシステム全体のヘルスチェック、パフォーマンス監視、異常検知時の自動通知。
* **セキュリティ強化:** IAMロールの最小権限設定、VPCの利用など、よりセキュアなインフラ構築。

### e. コンテナ技術の活用

* **Dockerの導入:** 開発環境のコンテナ化、Lambda関数でのDockerイメージ利用による依存関係管理の簡素化。
* **Kubernetesの学習:** 大規模なMLサービスやバックエンドサービスを運用する際の基盤技術として、概念と基本的な操作を習得。

### f. 開発プラクティスの深化

* **テスト駆動開発 (TDD):** コード品質の向上と変更への耐性強化。
* **ドメイン駆動設計 (DDD):** 複雑なビジネスロジックを持つドメインモデルの設計と実装。

---